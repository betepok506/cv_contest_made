# Описание 
Данный репозиторий содержит модель классификации для CV [контеста](https://www.kaggle.com/competitions/vk-made-sports-image-classification/overview)
Веса для модели: ссылка
# Установка

Сначала необходимо установить `torch` gpu нужной вам версии cuda. Если не планируете ипользовать gpu смело пропускайте этот шаг
```commandline
pip3 install torch torchvision torchaudio --index-url https://download.pytorch.org/whl/cu118
```

Далее для установки зависимостей выполните команду:
```commandline
pip install -r requirements.txt
```
# Запуск
Конфигурирование просиводится с помощью конфигов в каталоге `configs`.

Назначения конфигурационных файлов:
- `predict_params.yaml` --- конфигурационный файл для запуска пайплайна предсказания;
- `train_config.yaml` --- конфигурационный файл для запуска пайплайна обучения;
- `splitting_config.yaml` --- конфигурационный файл с параметрами для разделения датасета на test и valid.

## Обучение
Для запуска `train` необходимо настроить следующие параметры:

 - path_save_checkpoint --- Путь куда будут сохраняться checkpoints модели при обучени
 - path_to_classes --- JSON-файл, содержащий кодирование классов в числовые значения меток (По умолчанию находится в `data/encode_classes.json`)
 - path_to_weights --- Путь до модели, веса которой необходимо загрузить (Для дообучения)
 - path_to_dataset --- Путь до датасета

*Остальные параметры могут изменяться по желанию*
## Предсказание
Для запуска `predict` необходимо настроить следующие параметры:
- path_to_classes --- JSON-файл, содержащий кодирование классов в числовые значения меток (По умолчанию находится в `data/encode_classes.json`)
- path_to_weights --- Путь до модели, веса которой необходимо загрузить
- path_to_dataset --- Путь до датасета
- name_model --- Наименование архитектуры используемой при обучении
- path_to_save_result --- Путь сохранения результата классификации в виде csv файла
- visualize_result --- Параметр для копирования изображений в папку соответствующую результату классификации (Исключительно для визуальной оценки результатов классификации). Если True то сохраняем результат, иначе False
- path_to_save_images ---  Каталог для сохранения изображений из предыдущего параметра

*Остальные параметры могут изменяться по желанию*

## Разделение данных на test/valid
Для запуска `split_dataset` необходимо настроить следующие параметры:
- path_to_dataset --- Путь до датасета 
- test_size --- Доля тестового набора 
- name_file --- CSV файл, содержащий имена файлов